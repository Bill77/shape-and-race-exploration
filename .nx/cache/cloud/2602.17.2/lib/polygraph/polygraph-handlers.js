'use strict';const a5_0x1183c8=a5_0x3222;(function(_0x30ae19,_0x4c5658){const _0x388da2=a5_0x3222,_0x451de4=_0x30ae19();while(!![]){try{const _0x9523e9=-parseInt(_0x388da2(0x1a5))/0x1*(-parseInt(_0x388da2(0x16d))/0x2)+-parseInt(_0x388da2(0x14f))/0x3*(parseInt(_0x388da2(0xec))/0x4)+parseInt(_0x388da2(0x188))/0x5*(-parseInt(_0x388da2(0x1b3))/0x6)+-parseInt(_0x388da2(0x18a))/0x7+-parseInt(_0x388da2(0x12e))/0x8+-parseInt(_0x388da2(0x1b5))/0x9+parseInt(_0x388da2(0x197))/0xa;if(_0x9523e9===_0x4c5658)break;else _0x451de4['push'](_0x451de4['shift']());}catch(_0x363ab4){_0x451de4['push'](_0x451de4['shift']());}}}(a5_0xfa37,0x72c95));var __defProp=Object[a5_0x1183c8(0x184)],__getOwnPropDesc=Object[a5_0x1183c8(0x117)],__getOwnPropNames=Object[a5_0x1183c8(0x1c5)],__hasOwnProp=Object[a5_0x1183c8(0xea)][a5_0x1183c8(0x1b8)],__export=(_0x3cb3c7,_0x52b844)=>{for(var _0x2fbd53 in _0x52b844)__defProp(_0x3cb3c7,_0x2fbd53,{'get':_0x52b844[_0x2fbd53],'enumerable':!![]});},__copyProps=(_0x51c221,_0x1155af,_0x4ccdce,_0x2fb6e6)=>{const _0x1dc26a=a5_0x1183c8;if(_0x1155af&&typeof _0x1155af===_0x1dc26a(0x1b6)||typeof _0x1155af===_0x1dc26a(0x1d9)){for(let _0x167560 of __getOwnPropNames(_0x1155af))if(!__hasOwnProp['call'](_0x51c221,_0x167560)&&_0x167560!==_0x4ccdce)__defProp(_0x51c221,_0x167560,{'get':()=>_0x1155af[_0x167560],'enumerable':!(_0x2fb6e6=__getOwnPropDesc(_0x1155af,_0x167560))||_0x2fb6e6[_0x1dc26a(0x105)]});}return _0x51c221;},__toCommonJS=_0x9e7a91=>__copyProps(__defProp({},a5_0x1183c8(0xde),{'value':!![]}),_0x9e7a91),polygraph_handlers_exports={};__export(polygraph_handlers_exports,{'formatPolygraphSession':()=>formatPolygraphSession,'polygraphAssociatePR':()=>polygraphAssociatePR,'polygraphChildStatus':()=>polygraphChildStatus,'polygraphCreatePRs':()=>polygraphCreatePRs,'polygraphDelegate':()=>polygraphDelegate,'polygraphGetSession':()=>polygraphGetSession,'polygraphInit':()=>polygraphInit,'polygraphMarkReady':()=>polygraphMarkReady,'polygraphPushBranch':()=>polygraphPushBranch,'polygraphStopChild':()=>polygraphStopChild}),module[a5_0x1183c8(0x174)]=__toCommonJS(polygraph_handlers_exports);var POLYGRAPH_FETCH_TIMEOUT_MS=0x186a0;function a5_0xfa37(){const _0x519991=['\x20\x20CI:\x20',',\x20got\x20','\x20\x20CI:\x20No\x20pipeline\x20execution\x20found','No\x20child\x20agent\x20found\x20for\x20target\x20\x22','git\x20remote\x20get-url\x20origin','Dependencies\x20installed\x20successfully','GET','Failed\x20to\x20call\x20associate\x20PR\x20endpoint:\x20','yarn.lock','\x20->\x20','\x20has\x20expired','data','--continue','--force-with-lease','Session\x20initialized\x20successfully.\x0aSession\x20ID:\x20','\x0a\x0aTask:\x20','130yrnnVL','localPath','agentSessionId','env','network','PR\x20creation\x20request\x20failed:\x20','write','exports','failed','Stopping\x20child\x20for\x20workspace\x20','Found\x20repo\x20for\x20','stdio','parse','yarn','--experimental-polygraph','--count','...','push','\x20install','prUrl','authHeaders','toString','polygraphSessionUrl','defineProperty','set','Push\x20failed:\x20','clean','80cqovQM','results','1172255hlODqv','message','taskTimeout','/plan','repoFullName','rev-list','\x0a\x0aUse\x20cloud_polygraph_delegate\x20to\x20execute\x20tasks\x20across\x20these\x20repositories.','.\x0aAvailable\x20repositories:\x20','started','length','error','github','Remote\x20origin\x20URL\x20does\x20not\x20match\x20expected\x20repo\x20','31616170qwcdDQ','reset','execSync','edges','#\x20Polygraph\x20Child\x20Agent\x0a\x0aYou\x20are\x20operating\x20as\x20a\x20child\x20agent\x20in\x20a\x20Polygraph\x20multi-repository\x20coordination\x20session.\x0a\x0a##\x20Guidelines\x0a\x0a-\x20Focus\x20on\x20the\x20specific\x20task\x20delegated\x20to\x20you\x20by\x20the\x20parent\x20agent\x0a-\x20Make\x20changes\x20only\x20within\x20this\x20repository\x0a-\x20Provide\x20clear,\x20concise\x20status\x20updates\x20about\x20your\x20progress\x0a-\x20If\x20you\x20encounter\x20blocking\x20issues,\x20report\x20them\x20clearly\x20so\x20the\x20parent\x20agent\x20can\x20assist\x0a\x0a##\x20Context\x0a\x0aThis\x20skill\x20is\x20automatically\x20injected\x20when\x20this\x20repository\x20is\x20being\x20coordinated\x20as\x20part\x20of\x20a\x20larger\x20Polygraph\x20session.\x20The\x20parent\x20agent\x20will\x20provide\x20specific\x20instructions\x20for\x20the\x20task\x20at\x20hand.\x0a','Dependency\x20Graph:','stdin',']\x20Task\x20timed\x20out\x20after\x20','utf-8','Max\x20retries\x20(','process','child_process','pull','\x20already\x20exists,\x20resetting\x20to\x20clean\x20state','6081wxXYWA','npx','repos','kill','--hard','log','startTask','Failed\x20to\x20initialize\x20Polygraph\x20session:\x20','\x20PR(s)\x20ready','No\x20commits\x20ahead\x20of\x20base\x20branch','Pushing\x20','\x0aURL:\x20','readFileSync','Successfully\x20pushed\x20','316056FHizmH','--depth','8322129wXNupQ','object','HEAD:refs/heads/','hasOwnProperty','npm','\x20workspace(s)\x20and\x20','Stopped\x20child\x20agent\x20for\x20','vcsConfiguration','name','remote','createWriteStream','owner','title','substring','Task\x20started\x20for\x20','realpathSync','getOwnPropertyNames','session.json','agent-output.log','text','.nx/polygraph','\x20commit(s)\x20ahead\x20of\x20','SIGTERM','initiator','Session\x20ID','stopped','baseBranch','SIGKILL','nxCloudUrl','pullRequests','npm\x20install','Failed\x20to\x20get\x20remote\x20URL:\x20','Failed\x20to\x20mark\x20PRs\x20ready:\x20',']\x20stderr:\x20','stream-json','\x22\x20not\x20found\x20in\x20session\x20','function','nxCloudId','source','signal','Mark\x20ready\x20endpoint\x20returned\x20','\x20in\x20','Remote\x20origin\x20URL:\x20','claude','Repository\x20\x22','pipe','.\x20Use\x20stop_child\x20first.','--dangerously-skip-permissions','Failed\x20to\x20get\x20credentials:\x20','url','No\x20credential\x20found\x20for\x20workspace\x20','logFile','sessionId','Creating\x20PR\x20via\x20nx-api:\x20','completed','endsWith','Failed\x20to\x20clone\x20','Session:\x20','Status:\x20','\x20to\x20','POST','includes','stdout','call','No\x20Polygraph\x20session\x20found\x20with\x20ID:\x20','\x20credential(s)','durationMs','instruction','output','Failed\x20to\x20call\x20mark\x20ready\x20endpoint:\x20','Associating\x20PR\x20with\x20session:\x20','Resetting\x20clone\x20at\x20','workspaceId','repoPath','mkdirSync','.\x20Run\x20cloud_polygraph_init\x20first.','startsWith','Failed\x20to\x20get\x20remote\x20origin\x20URL:\x20','status','Failed\x20to\x20check\x20commits\x20ahead:\x20','currentInstruction','Resetting\x20all\x20child\x20agents','dependencyGraph','cipeUrl','/nx-cloud/polygraph/init-session','Failed\x20to\x20fetch\x20credentials:\x20','\x20PR(s)','Branch\x20name','/credentials','.nx','Failed\x20to\x20clone\x20repositories:\x20','Authentication\x20error:\x20','No\x20repo\x20registry\x20found\x20for\x20session\x20','\x20at\x20','existsSync','startedAt','\x20not\x20found\x20in\x20session','execFileSync','allSucceeded','Prompt:\x20','--print','writeFileSync','\x20must\x20not\x20be\x20empty','git','branch','clones','expiresAt','__esModule','https://x-access-token:@github.com/','SIGINT','retryCount','Starting\x20task\x20in\x20',']\x20Spawn\x20error:\x20','Failed\x20to\x20associate\x20PR:\x20','main','success','\x20\x20CIPE:\x20','Killing\x20process\x20for\x20workspace\x20','origin','prototype','clear','1429084ZifHPE','Error:\x20','getChildrenStatus','map','killAll','active','Marked\x20','stopChild','-fd','defaultBranch','.\x20Session\x20preserved\x20for\x20--continue.','find','\x20\x20Nodes:\x20','Request\x20body:\x20','repo','Making\x20polygraph\x20init-session\x20request\x20to:\x20','Repository\x20','dirname','end','PR\x20creation\x20failed:\x20','Workspaces:','some','split','debug','repositoryFullName','enumerable','agents','x-access-token:***@','.nx/polygraph/\x0a','get','\x0a.nx/polygraph/\x0a','values','\x20contains\x20invalid\x20characters','.git','body','..HEAD','set-url','stderr','running','trim','No\x20commits\x20ahead\x20of\x20base\x20branch\x20--\x20nothing\x20to\x20push','Failed\x20to\x20fetch\x20session:\x20','abort','getOwnPropertyDescriptor','credentials','URL:\x20','Network\x20error:\x20','/nx-cloud/polygraph/session/','Marking\x20session\x20PRs\x20ready\x20from:\x20','\x20\x20URL:\x20','--output-format','nx-mcp@latest','pnpm','toLowerCase','slice','A\x20task\x20is\x20already\x20running\x20for\x20workspace\x20','\x20(workspace:\x20','stringify','Stopping\x20child\x20agent\x20for\x20','Fetching\x20session\x20from:\x20','now','Session\x20initialized\x20but\x20no\x20workspaces\x20returned.\x0aSession\x20ID:\x20','Installing\x20dependencies\x20with\x20','.nx/polygraph/','path','nodes','6355872TZuEar','nrwl/nx-ai-agents-config','Failed\x20to\x20checkout\x20session\x20branch\x20\x22','workspaces','authentication','Failed\x20to\x20call\x20PR\x20creation\x20endpoint:\x20','pnpm-lock.yaml','validation','join','Git\x20push\x20failed:\x20','match','Credentials\x20endpoint\x20returned\x20','pending','/prs/create','logger','\x22\x20in\x20session\x20','bun.lockb','checkout','Retrieved\x20','pop','--system-prompt','settings.local.json','getChildOutput','plan','workspacePath','\x22\x20at\x20','Retrieved\x20session\x20with\x20','\x20not\x20found\x20in\x20repo\x20registry','Associated\x20PR\x20with\x20session\x20','prs','Base\x20branch','application/json','filter','3MKwhts','https://x-access-token:','replace',']\x20Claude\x20exited\x20with\x20code\x20','maxRetries','other','draft','Warning:\x20failed\x20to\x20save\x20session\x20plan:\x20','[stderr]\x20','Failed\x20to\x20install\x20dependencies\x20with\x20','prUrls','target','Failed\x20to\x20call\x20credentials\x20endpoint:\x20','number'];a5_0xfa37=function(){return _0x519991;};return a5_0xfa37();}function sanitizeError(_0x3a1da0){const _0x122995=a5_0x1183c8;return _0x3a1da0[_0x122995(0x151)](/x-access-token:[^@]+@/g,_0x122995(0x107));}function validateGitRef(_0x5122fe,_0x831d63){const _0x529d9c=a5_0x1183c8;if(!_0x5122fe||_0x5122fe['trim']()[_0x529d9c(0x193)]===0x0)return _0x831d63+_0x529d9c(0xd9);if(/[;&|`$(){}[\]!#~<>\\'"\s\x00-\x1f\x7f]/['test'](_0x5122fe))return _0x831d63+_0x529d9c(0x10c);if(_0x5122fe[_0x529d9c(0x1f2)]('..')||_0x5122fe[_0x529d9c(0x201)]('-')||_0x5122fe['startsWith']('.'))return _0x831d63+'\x20contains\x20invalid\x20git\x20ref\x20pattern';return null;}async function associatePolygraphPR(_0x5283af,_0x5a2a96){const _0x5b275d=a5_0x1183c8,_0x2c25a4=_0x5a2a96[_0x5b275d(0x1d1)]+_0x5b275d(0x11b)+encodeURIComponent(_0x5a2a96[_0x5b275d(0x1e9)])+'/prs/associate',_0x2d7ba2={'Content-Type':_0x5b275d(0x14d),..._0x5a2a96[_0x5b275d(0x181)]};_0x5283af[_0x5b275d(0x1aa)](_0x5b275d(0x1fb)+_0x2c25a4);try{const _0x30f775=new AbortController(),_0x6bb78c=setTimeout(()=>_0x30f775[_0x5b275d(0x116)](),POLYGRAPH_FETCH_TIMEOUT_MS),_0x3d782a=await fetch(_0x2c25a4,{'method':_0x5b275d(0x1f1),'headers':_0x2d7ba2,'body':JSON[_0x5b275d(0x125)]({..._0x5a2a96[_0x5b275d(0x180)]?{'prUrl':_0x5a2a96['prUrl']}:{},..._0x5a2a96[_0x5b275d(0xdb)]?{'branch':_0x5a2a96[_0x5b275d(0xdb)]}:{}}),'signal':_0x30f775[_0x5b275d(0x1dc)]});clearTimeout(_0x6bb78c);const _0x1d687a=await _0x3d782a[_0x5b275d(0x1c8)]();if(!_0x3d782a['ok'])return _0x5283af[_0x5b275d(0x1aa)](_0x5b275d(0xe4)+_0x3d782a['status']+'\x20'+_0x1d687a),{'success':![],'error':'Associate\x20PR\x20endpoint\x20returned\x20'+_0x3d782a[_0x5b275d(0x203)]+':\x20'+_0x1d687a};const _0x56d7d6=JSON[_0x5b275d(0x179)](_0x1d687a);return _0x5283af[_0x5b275d(0x1aa)](_0x5b275d(0x14a)+_0x56d7d6[_0x5b275d(0x1e9)]),{'success':!![],'sessionId':_0x56d7d6[_0x5b275d(0x1e9)],'prs':_0x56d7d6[_0x5b275d(0x14b)]};}catch(_0x56e2c2){const _0x33744f=_0x56e2c2 instanceof Error?_0x56e2c2['message']:String(_0x56e2c2);return _0x5283af[_0x5b275d(0x1aa)]('Failed\x20to\x20associate\x20PR:\x20'+_0x33744f),{'success':![],'error':_0x5b275d(0x164)+_0x33744f};}}async function createPolygraphPR(_0x326a2e,_0x4b3553){const _0x5a22dd=a5_0x1183c8;var _0xdbc05a;const _0x4a76bc=_0x4b3553[_0x5a22dd(0x1d1)]+_0x5a22dd(0x11b)+encodeURIComponent(_0x4b3553['sessionId'])+_0x5a22dd(0x13b),_0x1a4522={'Content-Type':_0x5a22dd(0x14d),..._0x4b3553[_0x5a22dd(0x181)]},_0x31ad10=JSON[_0x5a22dd(0x125)]({'title':_0x4b3553[_0x5a22dd(0x1c1)],'body':_0x4b3553[_0x5a22dd(0x10e)]||null,'headBranch':_0x4b3553['headBranch'],'baseBranch':_0x4b3553[_0x5a22dd(0x1cf)]||null,'draft':_0x4b3553[_0x5a22dd(0x155)]??!![],'workspaceId':_0x4b3553['workspaceId']});_0x326a2e[_0x5a22dd(0x1aa)](_0x5a22dd(0x1ea)+_0x4a76bc),(_0xdbc05a=_0x326a2e[_0x5a22dd(0x103)])==null?void 0x0:_0xdbc05a[_0x5a22dd(0x1f4)](_0x326a2e,_0x5a22dd(0xf9)+_0x31ad10);try{const _0x2504bf=new AbortController(),_0x4eb2bc=setTimeout(()=>_0x2504bf[_0x5a22dd(0x116)](),POLYGRAPH_FETCH_TIMEOUT_MS),_0x14d414=await fetch(_0x4a76bc,{'method':_0x5a22dd(0x1f1),'headers':_0x1a4522,'body':_0x31ad10,'signal':_0x2504bf[_0x5a22dd(0x1dc)]});clearTimeout(_0x4eb2bc);const _0x52dba7=await _0x14d414[_0x5a22dd(0x1c8)]();if(!_0x14d414['ok'])return _0x326a2e[_0x5a22dd(0x1aa)](_0x5a22dd(0xff)+_0x14d414[_0x5a22dd(0x203)]+'\x20'+_0x52dba7),{'success':![],'error':'PR\x20creation\x20endpoint\x20returned\x20'+_0x14d414['status']+':\x20'+_0x52dba7};const _0x40a289=JSON[_0x5a22dd(0x179)](_0x52dba7);return _0x326a2e['log']('PR\x20created\x20successfully:\x20'+_0x40a289[_0x5a22dd(0x1e6)]),{'success':!![],..._0x40a289};}catch(_0x24d2e8){const _0xa50170=_0x24d2e8 instanceof Error?_0x24d2e8[_0x5a22dd(0x18b)]:String(_0x24d2e8);return _0x326a2e[_0x5a22dd(0x1aa)](_0x5a22dd(0x172)+_0xa50170),{'success':![],'error':_0x5a22dd(0x133)+_0xa50170};}}async function getPolygraphSession(_0x1eb2f1,_0x1de181){const _0x76f56f=a5_0x1183c8;var _0x42838e,_0x582f4c;const _0x5787de=_0x1de181[_0x76f56f(0x1d1)]+_0x76f56f(0x11b)+encodeURIComponent(_0x1de181[_0x76f56f(0x1e9)]),_0x59a13d={'Content-Type':_0x76f56f(0x14d),..._0x1de181['authHeaders']};_0x1eb2f1[_0x76f56f(0x1aa)](_0x76f56f(0x127)+_0x5787de);try{const _0x2e75f2=new AbortController(),_0x36ff96=setTimeout(()=>_0x2e75f2['abort'](),POLYGRAPH_FETCH_TIMEOUT_MS),_0x4ee67f=await fetch(_0x5787de,{'method':_0x76f56f(0x163),'headers':_0x59a13d,'signal':_0x2e75f2[_0x76f56f(0x1dc)]});clearTimeout(_0x36ff96);const _0x4c2d3a=await _0x4ee67f[_0x76f56f(0x1c8)]();if(!_0x4ee67f['ok'])return _0x1eb2f1['log'](_0x76f56f(0x115)+_0x4ee67f[_0x76f56f(0x203)]+'\x20'+_0x4c2d3a),{'success':![],'error':'Get\x20session\x20endpoint\x20returned\x20'+_0x4ee67f[_0x76f56f(0x203)]+':\x20'+_0x4c2d3a};const _0x44e474=JSON['parse'](_0x4c2d3a);return _0x1eb2f1[_0x76f56f(0x1aa)](_0x76f56f(0x148)+(((_0x42838e=_0x44e474['workspaces'])==null?void 0x0:_0x42838e[_0x76f56f(0x193)])??0x0)+_0x76f56f(0x1ba)+(((_0x582f4c=_0x44e474[_0x76f56f(0x1d2)])==null?void 0x0:_0x582f4c['length'])??0x0)+_0x76f56f(0x20b)),{'success':!![],'session':_0x44e474};}catch(_0x53cb75){const _0x53f90b=_0x53cb75 instanceof Error?_0x53cb75['message']:String(_0x53cb75);return _0x1eb2f1[_0x76f56f(0x1aa)](_0x76f56f(0x115)+_0x53f90b),{'success':![],'error':'Failed\x20to\x20call\x20get\x20session\x20endpoint:\x20'+_0x53f90b};}}var import_child_process=require('child_process'),import_fs=require('fs'),import_os=require('os'),import_path=require(a5_0x1183c8(0x12c));async function initPolygraphSession(_0x72a1d,_0x3f4ba2){const _0x389b2d=a5_0x1183c8;var _0x2fa7b8;const _0x2e5242=_0x3f4ba2[_0x389b2d(0x1d1)]+_0x389b2d(0x209),_0x4004b3={'Content-Type':_0x389b2d(0x14d),..._0x3f4ba2[_0x389b2d(0x181)]},_0x400003=JSON[_0x389b2d(0x125)]({'sessionId':_0x3f4ba2[_0x389b2d(0x1e9)],'workspaceId':_0x3f4ba2[_0x389b2d(0x1da)]});_0x72a1d['log'](_0x389b2d(0xfb)+_0x2e5242),_0x72a1d[_0x389b2d(0x1aa)]('Request\x20headers:\x20'+JSON['stringify'](_0x4004b3,null,0x2)),_0x72a1d['log']('Request\x20body:\x20'+_0x400003);try{const _0x4dd6b5=new AbortController(),_0x151514=setTimeout(()=>_0x4dd6b5[_0x389b2d(0x116)](),POLYGRAPH_FETCH_TIMEOUT_MS),_0x13eb6b=await fetch(_0x2e5242,{'method':_0x389b2d(0x1f1),'headers':_0x4004b3,'body':_0x400003,'signal':_0x4dd6b5[_0x389b2d(0x1dc)]});clearTimeout(_0x151514);const _0x3b4fac=await _0x13eb6b[_0x389b2d(0x1c8)]();if(!_0x13eb6b['ok']){if(_0x13eb6b['status']===0x191)return _0x72a1d[_0x389b2d(0x1aa)](_0x389b2d(0xce)+_0x3b4fac),{'url':_0x2e5242,'error':{'type':_0x389b2d(0x132),'message':_0x3b4fac}};return _0x72a1d[_0x389b2d(0x1aa)](_0x389b2d(0xed)+_0x13eb6b['status']+'\x20'+_0x3b4fac),{'url':_0x2e5242,'error':{'type':_0x389b2d(0x154),'message':_0x3b4fac}};}const _0x36d5e4=JSON['parse'](_0x3b4fac);return(_0x2fa7b8=_0x72a1d[_0x389b2d(0x103)])==null?void 0x0:_0x2fa7b8[_0x389b2d(0x1f4)](_0x72a1d,'Polygraph\x20init-session\x20response:\x20'+JSON[_0x389b2d(0x125)](_0x36d5e4)),{'url':_0x2e5242,'data':_0x36d5e4};}catch(_0x44dc20){const _0x39ed18=_0x44dc20 instanceof Error?_0x44dc20['message']:String(_0x44dc20);return _0x72a1d[_0x389b2d(0x1aa)](_0x389b2d(0x11a)+_0x39ed18),{'url':_0x2e5242,'error':{'type':_0x389b2d(0x171),'message':_0x39ed18}};}}function getRegistryPath(_0x3d3035,_0x4bf661){const _0xc8f524=a5_0x1183c8;return(0x0,import_path[_0xc8f524(0x136)])(_0x3d3035,_0xc8f524(0xcc),'polygraph',_0x4bf661,_0xc8f524(0x1c6));}function a5_0x3222(_0x5b69bc,_0x4fd330){const _0xfa37cd=a5_0xfa37();return a5_0x3222=function(_0x32222f,_0x7da89d){_0x32222f=_0x32222f-0xcc;let _0xbd78db=_0xfa37cd[_0x32222f];return _0xbd78db;},a5_0x3222(_0x5b69bc,_0x4fd330);}async function ensurePolygraphGitignore(_0x3eecbc){const _0x545747=a5_0x1183c8,_0x1c1e5a=(0x0,import_path['join'])(_0x3eecbc,'.gitignore');if(!(0x0,import_fs[_0x545747(0xd1)])(_0x1c1e5a))return;const _0x2401cc=(0x0,import_fs[_0x545747(0x1b1)])(_0x1c1e5a,_0x545747(0x19f)),_0x28d6cb=_0x2401cc[_0x545747(0x102)]('\x0a');if(_0x28d6cb[_0x545747(0x101)](_0x566478=>_0x566478['trim']()===_0x545747(0x1c9)||_0x566478[_0x545747(0x113)]()===_0x545747(0x12b)))return;const _0x3f4cb3=_0x2401cc[_0x545747(0x1ec)]('\x0a')?_0x2401cc+_0x545747(0x108):_0x2401cc+_0x545747(0x10a);(0x0,import_fs[_0x545747(0xd8)])(_0x1c1e5a,_0x3f4cb3,_0x545747(0x19f));}function loadRepoRegistry(_0x3700a1){const _0x2190b7=a5_0x1183c8;if(!(0x0,import_fs['existsSync'])(_0x3700a1))return null;try{const _0x5394f9=(0x0,import_fs[_0x2190b7(0x1b1)])(_0x3700a1,_0x2190b7(0x19f));return JSON['parse'](_0x5394f9);}catch{return null;}}function saveRepoRegistry(_0x1e3491,_0x2fc435){const _0x13e30a=a5_0x1183c8,_0x48b93e=(0x0,import_path[_0x13e30a(0xfd)])(_0x1e3491);!(0x0,import_fs[_0x13e30a(0xd1)])(_0x48b93e)&&(0x0,import_fs['mkdirSync'])(_0x48b93e,{'recursive':!![]}),(0x0,import_fs[_0x13e30a(0xd8)])(_0x1e3491,JSON[_0x13e30a(0x125)](_0x2fc435,null,0x2),'utf-8');}function getClonePath(_0x2f90bf,_0x237b59){const _0xa818e5=a5_0x1183c8;return(0x0,import_path[_0xa818e5(0x136)])((0x0,import_fs[_0xa818e5(0x1c4)])((0x0,import_os['tmpdir'])()),'polygraph',_0x2f90bf,_0x237b59);}function isValidClone(_0x29e60a){const _0xfccfce=a5_0x1183c8;if(!(0x0,import_fs[_0xfccfce(0xd1)])(_0x29e60a))return![];try{return(0x0,import_child_process[_0xfccfce(0x199)])('git\x20rev-parse\x20--git-dir',{'cwd':_0x29e60a,'stdio':_0xfccfce(0x1e2)}),!![];}catch{return![];}}function detectPackageManager(_0x4a398b){const _0x13706b=a5_0x1183c8;if((0x0,import_fs[_0x13706b(0xd1)])((0x0,import_path[_0x13706b(0x136)])(_0x4a398b,_0x13706b(0x134))))return _0x13706b(0x120);if((0x0,import_fs[_0x13706b(0xd1)])((0x0,import_path[_0x13706b(0x136)])(_0x4a398b,_0x13706b(0x165))))return _0x13706b(0x17a);if((0x0,import_fs['existsSync'])((0x0,import_path[_0x13706b(0x136)])(_0x4a398b,_0x13706b(0x13e))))return'bun';return'npm';}function installDependencies(_0xcaee8,_0xe33b8){const _0x253f38=a5_0x1183c8,_0x1e69be=detectPackageManager(_0xcaee8),_0x18a1b7=_0x1e69be===_0x253f38(0x1b9)?_0x253f38(0x1d3):_0x1e69be+_0x253f38(0x17f);_0xe33b8[_0x253f38(0x1aa)](_0x253f38(0x12a)+_0x1e69be+_0x253f38(0x1de)+_0xcaee8);try{(0x0,import_child_process['execSync'])(_0x18a1b7,{'cwd':_0xcaee8,'stdio':'ignore','env':{...process[_0x253f38(0x170)]}}),_0xe33b8[_0x253f38(0x1aa)](_0x253f38(0x162));}catch(_0x59b29d){const _0x58579a=_0x59b29d instanceof Error?_0x59b29d['message']:String(_0x59b29d);throw new Error(_0x253f38(0x158)+_0x1e69be+':\x20'+_0x58579a);}}function resetCloneToCleanState(_0x4ea283,_0x3deb68,_0x5e3c55){const _0x2cfae7=a5_0x1183c8;_0x5e3c55[_0x2cfae7(0x1aa)](_0x2cfae7(0x1fc)+_0x4ea283+_0x2cfae7(0x1f0)+_0x3deb68);const _0x59c022={...process['env'],'GIT_TERMINAL_PROMPT':'0'},_0x16f478=validateGitRef(_0x3deb68,_0x2cfae7(0x20c));if(_0x16f478)throw new Error(_0x16f478);try{(0x0,import_child_process[_0x2cfae7(0xd4)])('git',[_0x2cfae7(0x13f),_0x3deb68],{'cwd':_0x4ea283,'stdio':_0x2cfae7(0x1e2),'env':_0x59c022}),(0x0,import_child_process['execFileSync'])(_0x2cfae7(0xda),[_0x2cfae7(0x198),_0x2cfae7(0x1a9)],{'cwd':_0x4ea283,'stdio':_0x2cfae7(0x1e2),'env':_0x59c022}),(0x0,import_child_process[_0x2cfae7(0xd4)])(_0x2cfae7(0xda),[_0x2cfae7(0x187),_0x2cfae7(0xf4)],{'cwd':_0x4ea283,'stdio':_0x2cfae7(0x1e2),'env':_0x59c022}),(0x0,import_child_process[_0x2cfae7(0xd4)])(_0x2cfae7(0xda),[_0x2cfae7(0x1a3),_0x2cfae7(0xe9),_0x3deb68],{'cwd':_0x4ea283,'stdio':_0x2cfae7(0x1e2),'env':_0x59c022});}catch(_0x117754){const _0x1202d8=_0x117754 instanceof Error?_0x117754['message']:String(_0x117754);throw new Error('Failed\x20to\x20reset\x20clone\x20at\x20'+_0x4ea283+':\x20'+_0x1202d8);}}function cloneRepo(_0x151d76,_0x333fbc,_0x294738,_0x14d8c5){const _0x10a606=a5_0x1183c8;_0x14d8c5['log']('Cloning\x20'+_0x151d76+_0x10a606(0x1f0)+_0x294738);const _0x771242=(0x0,import_path[_0x10a606(0xfd)])(_0x294738);!(0x0,import_fs[_0x10a606(0xd1)])(_0x771242)&&(0x0,import_fs[_0x10a606(0x1ff)])(_0x771242,{'recursive':!![]});const _0xf7208e=_0x10a606(0x150)+_0x333fbc+'@github.com/'+_0x151d76+_0x10a606(0x10d);try{(0x0,import_child_process[_0x10a606(0xd4)])(_0x10a606(0xda),['clone',_0x10a606(0x1b4),'1',_0xf7208e,_0x294738],{'stdio':_0x10a606(0x1e2),'env':{...process['env'],'GIT_TERMINAL_PROMPT':'0'}});}catch(_0x2340e9){const _0xfc9fba=_0x2340e9 instanceof Error?_0x2340e9['message']:String(_0x2340e9);throw new Error(_0x10a606(0x1ed)+_0x151d76+':\x20'+sanitizeError(_0xfc9fba));}finally{try{(0x0,import_child_process['execFileSync'])(_0x10a606(0xda),[_0x10a606(0x1be),_0x10a606(0x110),'origin',_0x10a606(0xdf)+_0x151d76+_0x10a606(0x10d)],{'cwd':_0x294738});}catch{}}}function checkoutSessionBranch(_0x242c62,_0x23dc93,_0x47ff9a){const _0x12288d=a5_0x1183c8,_0x4e954a=validateGitRef(_0x23dc93,_0x12288d(0x1cd));if(_0x4e954a)throw new Error(_0x4e954a);_0x47ff9a[_0x12288d(0x1aa)]('Checking\x20out\x20session\x20branch\x20\x22'+_0x23dc93+_0x12288d(0x147)+_0x242c62);const _0x213c17={...process[_0x12288d(0x170)],'GIT_TERMINAL_PROMPT':'0'};try{(0x0,import_child_process['execFileSync'])(_0x12288d(0xda),['checkout','-B',_0x23dc93],{'cwd':_0x242c62,'stdio':_0x12288d(0x1e2),'env':_0x213c17});}catch(_0x2b3191){const _0x468cfb=_0x2b3191 instanceof Error?_0x2b3191[_0x12288d(0x18b)]:String(_0x2b3191);throw new Error(_0x12288d(0x130)+_0x23dc93+_0x12288d(0x147)+_0x242c62+':\x20'+_0x468cfb);}}function cloneOrResetRepo(_0x454abe,_0x58e0c6,_0x538137,_0x4fe9d1,_0x349549){const _0x56b47e=a5_0x1183c8,_0x4331ba=_0x454abe[_0x56b47e(0x1bc)][_0x56b47e(0x104)],_0x2fb8e2=_0x4331ba[_0x56b47e(0x102)]('/')[_0x56b47e(0x141)]()??_0x4331ba,_0x10f9b0=getClonePath(_0x538137,_0x2fb8e2);if(_0x58e0c6[_0x56b47e(0xdd)]<Date[_0x56b47e(0x128)]())throw new Error('Credential\x20for\x20workspace\x20'+_0x454abe[_0x56b47e(0x1bd)]+_0x56b47e(0x167));const _0x484400=_0x4fe9d1[_0x56b47e(0x1a7)][_0x56b47e(0xf7)](_0x510970=>_0x510970[_0x56b47e(0x1fd)]===_0x454abe['id']);if(_0x484400&&isValidClone(_0x484400['localPath']))return resetCloneToCleanState(_0x484400[_0x56b47e(0x16e)],_0x454abe[_0x56b47e(0xf5)],_0x349549),checkoutSessionBranch(_0x484400[_0x56b47e(0x16e)],_0x538137,_0x349549),_0x484400;return isValidClone(_0x10f9b0)?(_0x349549[_0x56b47e(0x1aa)]('Directory\x20'+_0x10f9b0+_0x56b47e(0x1a4)),resetCloneToCleanState(_0x10f9b0,_0x454abe[_0x56b47e(0xf5)],_0x349549)):cloneRepo(_0x4331ba,_0x58e0c6['token'],_0x10f9b0,_0x349549),checkoutSessionBranch(_0x10f9b0,_0x538137,_0x349549),installDependencies(_0x10f9b0,_0x349549),{'workspaceId':_0x454abe['id'],'repoFullName':_0x4331ba,'localPath':_0x10f9b0,'defaultBranch':_0x454abe[_0x56b47e(0xf5)],'initiator':_0x454abe[_0x56b47e(0x1cc)],'clonedAt':Date[_0x56b47e(0x128)]()};}async function clonePolygraphRepositories(_0xc19305,_0x3e0074,_0x149fcd){const _0x705ba4=a5_0x1183c8,{sessionId:_0x1cce55,workspaces:_0x5a80ee,credentials:_0xd09294}=_0x149fcd;try{await ensurePolygraphGitignore(_0xc19305);const _0x2c2aa3=getRegistryPath(_0xc19305,_0x1cce55);let _0x12fe4f=loadRepoRegistry(_0x2c2aa3);!_0x12fe4f&&(_0x12fe4f={'sessionId':_0x1cce55,'createdAt':Date[_0x705ba4(0x128)](),'repos':[]});const _0x2782ab=[],_0x112447=_0x5a80ee[_0x705ba4(0xf7)](_0x73842a=>_0x73842a['initiator']);_0x112447&&_0x2782ab[_0x705ba4(0x17e)]({'workspaceId':_0x112447['id'],'repoFullName':_0x112447[_0x705ba4(0x1bc)][_0x705ba4(0x104)],'localPath':_0xc19305,'defaultBranch':_0x112447[_0x705ba4(0xf5)],'initiator':!![],'clonedAt':Date[_0x705ba4(0x128)]()});const _0x2833c6=_0x5a80ee[_0x705ba4(0x14e)](_0xee37be=>!_0xee37be['initiator']);for(const _0x2169ea of _0x2833c6){const _0x527770=_0xd09294[_0x705ba4(0xf7)](_0x4d80a1=>_0x4d80a1[_0x705ba4(0x1fd)]===_0x2169ea['id']);if(!_0x527770)throw new Error(_0x705ba4(0x1e7)+_0x2169ea['name']+'\x20('+_0x2169ea['id']+')');const _0x532b31=cloneOrResetRepo(_0x2169ea,_0x527770,_0x1cce55,_0x12fe4f,_0x3e0074);_0x2782ab['push'](_0x532b31);}return _0x12fe4f['repos']=_0x2782ab,saveRepoRegistry(_0x2c2aa3,_0x12fe4f),{'success':!![],'sessionId':_0x1cce55,'clones':_0x2782ab};}catch(_0x1cc261){const _0xcb74f1=_0x1cc261 instanceof Error?_0x1cc261['message']:String(_0x1cc261);return _0x3e0074[_0x705ba4(0x1aa)](_0x705ba4(0xcd)+_0xcb74f1),{'success':![],'sessionId':_0x1cce55,'clones':[],'error':_0xcb74f1};}}async function markPolygraphPRsReady(_0x310823,_0x6f5938){const _0x257c44=a5_0x1183c8,_0x2bbaab=_0x6f5938['nxCloudUrl']+_0x257c44(0x11b)+encodeURIComponent(_0x6f5938[_0x257c44(0x1e9)])+'/prs/mark-ready',_0x3be5ac={'Content-Type':_0x257c44(0x14d),..._0x6f5938['authHeaders']};_0x310823[_0x257c44(0x1aa)](_0x257c44(0x11c)+_0x2bbaab);try{const _0x33b66a=new AbortController(),_0x367603=setTimeout(()=>_0x33b66a[_0x257c44(0x116)](),POLYGRAPH_FETCH_TIMEOUT_MS),_0x45dff3=await fetch(_0x2bbaab,{'method':'POST','headers':_0x3be5ac,'body':JSON[_0x257c44(0x125)]({'prUrls':_0x6f5938[_0x257c44(0x159)]}),'signal':_0x33b66a[_0x257c44(0x1dc)]});clearTimeout(_0x367603);const _0x1600b6=await _0x45dff3[_0x257c44(0x1c8)]();if(!_0x45dff3['ok'])return _0x310823['log']('Failed\x20to\x20mark\x20PRs\x20ready:\x20'+_0x45dff3[_0x257c44(0x203)]+'\x20'+_0x1600b6),{'success':![],'error':_0x257c44(0x1dd)+_0x45dff3[_0x257c44(0x203)]+':\x20'+_0x1600b6};const _0xd8c86f=JSON[_0x257c44(0x179)](_0x1600b6),_0x5e0b94=_0xd8c86f[_0x257c44(0x189)]['map'](_0x343eab=>({'url':_0x343eab[_0x257c44(0x180)],'number':_0x343eab['prNumber'],'success':_0x343eab['success'],'error':_0x343eab[_0x257c44(0x194)]}));return _0x310823[_0x257c44(0x1aa)](_0x257c44(0xf2)+_0x5e0b94[_0x257c44(0x14e)](_0x9b74b7=>_0x9b74b7[_0x257c44(0xe6)])[_0x257c44(0x193)]+'/'+_0x5e0b94[_0x257c44(0x193)]+_0x257c44(0x1ad)),{'success':!![],'results':_0x5e0b94,'allSucceeded':_0xd8c86f[_0x257c44(0xd5)]};}catch(_0x4eb836){const _0x19b562=_0x4eb836 instanceof Error?_0x4eb836[_0x257c44(0x18b)]:String(_0x4eb836);return _0x310823[_0x257c44(0x1aa)](_0x257c44(0x1d5)+_0x19b562),{'success':![],'error':_0x257c44(0x1fa)+_0x19b562};}}var import_child_process2=require(a5_0x1183c8(0x1a2)),import_fs2=require('fs'),import_path2=require(a5_0x1183c8(0x12c));function ensureSandboxAndMCP(_0x1328cd){const _0x571894=a5_0x1183c8,_0x1de666=(0x0,import_path2['join'])(_0x1328cd,'.claude');!(0x0,import_fs2[_0x571894(0xd1)])(_0x1de666)&&(0x0,import_fs2[_0x571894(0x1ff)])(_0x1de666,{'recursive':!![]});const _0xbf2392=(0x0,import_path2[_0x571894(0x136)])(_0x1de666,_0x571894(0x143)),_0xa7d4dd={'extraKnownMarketplaces':{'nx-claude-plugins':{'source':{'source':_0x571894(0x195),'repo':_0x571894(0x12f)}}},'enabledPlugins':{'nx@nx-claude-plugins':!![]},'enableAllProjectMcpServers':!![],'enabledMcpjsonServers':['nx'],'mcpServers':{'nx-mcp':{'type':_0x571894(0x178),'command':_0x571894(0x1a6),'args':[_0x571894(0x11f),_0x571894(0x17b)]}}};(0x0,import_fs2['writeFileSync'])(_0xbf2392,JSON[_0x571894(0x125)](_0xa7d4dd,null,0x2),_0x571894(0x19f));}var POLYGRAPH_CHILD_SYSTEM_PROMPT=a5_0x1183c8(0x19b),ChildAgentManager=class{constructor(_0x5f5d53){const _0x4a3dd2=a5_0x1183c8;this[_0x4a3dd2(0x13c)]=_0x5f5d53;}[a5_0x1183c8(0x106)]=new Map();[a5_0x1183c8(0x153)]=0x3;['taskTimeout']=0x19*0x3c*0x3e8;[a5_0x1183c8(0x1ab)](_0x440501,_0x399e45,_0xdc43de,_0x4c147b){const _0x55d390=a5_0x1183c8;let _0xb2281f=this[_0x55d390(0x106)][_0x55d390(0x109)](_0x440501);if((_0xb2281f==null?void 0x0:_0xb2281f['status'])==='running')return{'started':![],'error':_0x55d390(0x123)+_0x440501+_0x55d390(0x1e3)};!_0xb2281f&&(_0xb2281f={'workspaceId':_0x440501,'repoPath':_0x399e45,'process':null,'status':_0x55d390(0x13a),'retryCount':0x0,'logFile':null,'currentInstruction':'','startedAt':null},this[_0x55d390(0x106)][_0x55d390(0x185)](_0x440501,_0xb2281f));if(_0xb2281f[_0x55d390(0xe1)]>=this[_0x55d390(0x153)])return{'started':![],'error':_0x55d390(0x1a0)+this[_0x55d390(0x153)]+')\x20exceeded\x20for\x20workspace\x20'+_0x440501};const _0x51536d=_0x4c147b?'Context:\x20'+_0x4c147b+_0x55d390(0x16c)+_0xdc43de:_0xdc43de;ensureSandboxAndMCP(_0x399e45);const _0x477ad5=(0x0,import_path2[_0x55d390(0x136)])(_0x399e45,_0x55d390(0xcc));!(0x0,import_fs2['existsSync'])(_0x477ad5)&&(0x0,import_fs2[_0x55d390(0x1ff)])(_0x477ad5,{'recursive':!![]});const _0x393405=(0x0,import_path2[_0x55d390(0x136)])(_0x477ad5,_0x55d390(0x1c7));(0x0,import_fs2[_0x55d390(0xd8)])(_0x393405,'',_0x55d390(0x19f)),_0xb2281f[_0x55d390(0x1e8)]=_0x393405,_0xb2281f[_0x55d390(0x205)]=_0xdc43de,_0xb2281f[_0x55d390(0xd2)]=Date[_0x55d390(0x128)]();const _0x214285=(0x0,import_fs2[_0x55d390(0x1bf)])(_0x393405,{'flags':'a'}),_0x39a0d8=[_0x55d390(0x169),_0x55d390(0xd7),_0x55d390(0x11e),_0x55d390(0x1d7),'--verbose',_0x55d390(0x1e4),_0x55d390(0x142),POLYGRAPH_CHILD_SYSTEM_PROMPT];this[_0x55d390(0x13c)]['log'](_0x55d390(0xe2)+_0x399e45),this[_0x55d390(0x13c)][_0x55d390(0x1aa)](_0x55d390(0xd6)+_0x51536d[_0x55d390(0x1c2)](0x0,0xc8)+_0x55d390(0x17d)),_0xb2281f[_0x55d390(0x203)]=_0x55d390(0x112);const _0x310a94=(0x0,import_child_process2['spawn'])(_0x55d390(0x1e0),_0x39a0d8,{'cwd':_0x399e45,'env':{...process[_0x55d390(0x170)]}});_0xb2281f[_0x55d390(0x1a1)]=_0x310a94,_0x310a94[_0x55d390(0x19d)][_0x55d390(0x173)](_0x51536d),_0x310a94[_0x55d390(0x19d)][_0x55d390(0xfe)](),_0x310a94[_0x55d390(0x1f3)]['on'](_0x55d390(0x168),_0x1f8f6f=>{const _0x32163f=_0x55d390,_0x2c3747=_0x1f8f6f[_0x32163f(0x182)]();_0x214285['write'](_0x2c3747),this[_0x32163f(0x13c)][_0x32163f(0x1aa)]('['+_0x440501+']\x20stdout:\x20'+_0x2c3747[_0x32163f(0x1c2)](0x0,0x64)+(_0x2c3747[_0x32163f(0x193)]>0x64?_0x32163f(0x17d):''));}),_0x310a94[_0x55d390(0x111)]['on']('data',_0x32ee90=>{const _0x4379c1=_0x55d390,_0x3b70eb=_0x32ee90[_0x4379c1(0x182)]();_0x214285[_0x4379c1(0x173)](_0x4379c1(0x157)+_0x3b70eb),this[_0x4379c1(0x13c)][_0x4379c1(0x1aa)]('['+_0x440501+_0x4379c1(0x1d6)+_0x3b70eb);});const _0x4369a1=setTimeout(()=>{const _0x3fe822=_0x55d390;this[_0x3fe822(0x13c)][_0x3fe822(0x1aa)]('['+_0x440501+_0x3fe822(0x19e)+this['taskTimeout']+'ms'),_0x214285[_0x3fe822(0xfe)](),_0x310a94[_0x3fe822(0x1a8)](),_0xb2281f[_0x3fe822(0x203)]=_0x3fe822(0x175),_0xb2281f[_0x3fe822(0x1a1)]=null,_0xb2281f[_0x3fe822(0xe1)]++;},this[_0x55d390(0x18c)]);return _0x310a94['on']('close',_0xdd3620=>{const _0x582265=_0x55d390;clearTimeout(_0x4369a1),_0x214285[_0x582265(0xfe)](),_0xb2281f['process']=null,this[_0x582265(0x13c)][_0x582265(0x1aa)]('['+_0x440501+_0x582265(0x152)+_0xdd3620),_0xdd3620===0x0?(_0xb2281f[_0x582265(0x203)]=_0x582265(0x1eb),_0xb2281f[_0x582265(0xe1)]=0x0):(_0xb2281f[_0x582265(0x203)]=_0x582265(0x175),_0xb2281f[_0x582265(0xe1)]++);}),_0x310a94['on'](_0x55d390(0x194),_0x161faf=>{const _0x15deb2=_0x55d390;clearTimeout(_0x4369a1),_0x214285['end'](),_0xb2281f[_0x15deb2(0x1a1)]=null,_0xb2281f[_0x15deb2(0x203)]=_0x15deb2(0x175),_0xb2281f[_0x15deb2(0xe1)]++,this[_0x15deb2(0x13c)][_0x15deb2(0x1aa)]('['+_0x440501+_0x15deb2(0xe3)+_0x161faf[_0x15deb2(0x18b)]);}),{'started':!![]};}[a5_0x1183c8(0x1a8)](_0xf49800){const _0x3080b1=a5_0x1183c8,_0xd7dbf5=this[_0x3080b1(0x106)][_0x3080b1(0x109)](_0xf49800);(_0xd7dbf5==null?void 0x0:_0xd7dbf5[_0x3080b1(0x1a1)])&&(this[_0x3080b1(0x13c)][_0x3080b1(0x1aa)](_0x3080b1(0xe8)+_0xf49800),_0xd7dbf5[_0x3080b1(0x1a1)]['kill'](),_0xd7dbf5[_0x3080b1(0x1a1)]=null,_0xd7dbf5['status']='failed');}[a5_0x1183c8(0xf0)](){const _0x5914e1=a5_0x1183c8;this['logger'][_0x5914e1(0x1aa)]('Killing\x20all\x20child\x20agent\x20processes');for(const [_0xfb9395]of this[_0x5914e1(0x106)]){this['kill'](_0xfb9395);}}[a5_0x1183c8(0x198)](){const _0x485d6f=a5_0x1183c8;this[_0x485d6f(0x13c)][_0x485d6f(0x1aa)](_0x485d6f(0x206));for(const [_0x194dfb]of this[_0x485d6f(0x106)]){const _0x29a5a3=this[_0x485d6f(0x106)]['get'](_0x194dfb);(_0x29a5a3==null?void 0x0:_0x29a5a3[_0x485d6f(0x1a1)])&&this[_0x485d6f(0xf3)](_0x194dfb);}this['agents'][_0x485d6f(0xeb)]();}[a5_0x1183c8(0xf3)](_0x41544e){const _0x549d1f=a5_0x1183c8,_0x864899=this['agents'][_0x549d1f(0x109)](_0x41544e);if(!_0x864899)return{'stopped':![],'output':''};let _0x1f0b5c='';if(_0x864899['logFile'])try{_0x1f0b5c=(0x0,import_fs2['readFileSync'])(_0x864899[_0x549d1f(0x1e8)],_0x549d1f(0x19f));}catch{}if(_0x864899[_0x549d1f(0x1a1)]){this[_0x549d1f(0x13c)][_0x549d1f(0x1aa)](_0x549d1f(0x176)+_0x41544e),_0x864899[_0x549d1f(0x1a1)][_0x549d1f(0x1a8)](_0x549d1f(0x1cb));const _0x357c2d=_0x864899['process'];setTimeout(()=>{const _0x1d229d=_0x549d1f;try{_0x357c2d[_0x1d229d(0x1a8)](_0x1d229d(0x1d0));}catch{}},0x1388),_0x864899[_0x549d1f(0x1a1)]=null;}return _0x864899[_0x549d1f(0x203)]='stopped',{'stopped':!![],'output':_0x1f0b5c};}[a5_0x1183c8(0x144)](_0x4571fd,_0x5cf092){const _0x1198ca=a5_0x1183c8,_0x3e7312=this[_0x1198ca(0x106)][_0x1198ca(0x109)](_0x4571fd);if(!(_0x3e7312==null?void 0x0:_0x3e7312[_0x1198ca(0x1e8)]))return null;try{const _0x26fa7a=(0x0,import_fs2['readFileSync'])(_0x3e7312['logFile'],'utf-8');if(_0x5cf092&&_0x5cf092>0x0){const _0x17f874=_0x26fa7a['split']('\x0a');return _0x17f874[_0x1198ca(0x122)](-_0x5cf092)[_0x1198ca(0x136)]('\x0a');}return _0x26fa7a;}catch{return null;}}[a5_0x1183c8(0xee)](){const _0x239c3f=a5_0x1183c8,_0x4ed5a7=[];for(const _0x43d215 of this[_0x239c3f(0x106)][_0x239c3f(0x10b)]()){const _0x3db2c4=_0x43d215['startedAt']&&_0x43d215[_0x239c3f(0x203)]==='running'?Date[_0x239c3f(0x128)]()-_0x43d215[_0x239c3f(0xd2)]:_0x43d215[_0x239c3f(0xd2)]?Date[_0x239c3f(0x128)]()-_0x43d215[_0x239c3f(0xd2)]:null;_0x4ed5a7[_0x239c3f(0x17e)]({'workspaceId':_0x43d215['workspaceId'],'repoPath':_0x43d215[_0x239c3f(0x1fe)],'status':_0x43d215[_0x239c3f(0x203)],'durationMs':_0x3db2c4,'instruction':_0x43d215[_0x239c3f(0x205)]});}return _0x4ed5a7;}['activeCount'](){const _0x50b5ea=a5_0x1183c8;let _0x191562=0x0;for(const _0xc32f42 of this['agents'][_0x50b5ea(0x10b)]()){_0xc32f42[_0x50b5ea(0x1a1)]!==null&&_0x191562++;}return _0x191562;}},import_child_process3=require(a5_0x1183c8(0x1a2));async function getPolygraphCredentials(_0xe0d019,_0x679390){const _0x54f30a=a5_0x1183c8,_0x110cd7=_0x679390[_0x54f30a(0x1d1)]+_0x54f30a(0x11b)+encodeURIComponent(_0x679390[_0x54f30a(0x1e9)])+_0x54f30a(0x20d),_0x51ce17={'Content-Type':_0x54f30a(0x14d),..._0x679390[_0x54f30a(0x181)]};_0xe0d019[_0x54f30a(0x1aa)]('Fetching\x20session\x20credentials\x20from:\x20'+_0x110cd7);try{const _0x104af5=new AbortController(),_0x31b090=setTimeout(()=>_0x104af5['abort'](),POLYGRAPH_FETCH_TIMEOUT_MS),_0x5e593c=await fetch(_0x110cd7,{'method':_0x54f30a(0x1f1),'headers':_0x51ce17,'signal':_0x104af5[_0x54f30a(0x1dc)]});clearTimeout(_0x31b090);const _0x68a951=await _0x5e593c['text']();if(!_0x5e593c['ok'])return _0xe0d019['log']('Failed\x20to\x20fetch\x20credentials:\x20'+_0x5e593c[_0x54f30a(0x203)]+'\x20'+_0x68a951),{'success':![],'error':_0x54f30a(0x139)+_0x5e593c['status']+':\x20'+_0x68a951};const _0x133706=JSON[_0x54f30a(0x179)](_0x68a951);return _0xe0d019[_0x54f30a(0x1aa)](_0x54f30a(0x140)+_0x133706['credentials'][_0x54f30a(0x193)]+_0x54f30a(0x1f6)),{'success':!![],'credentials':_0x133706[_0x54f30a(0x118)]};}catch(_0x410485){const _0x18839b=_0x410485 instanceof Error?_0x410485['message']:String(_0x410485);return _0xe0d019[_0x54f30a(0x1aa)](_0x54f30a(0x20a)+_0x18839b),{'success':![],'error':_0x54f30a(0x15b)+_0x18839b};}}function getDefaultBranch(_0x3146a3,_0x2b4e2a=a5_0x1183c8(0xe5)){const _0x10efa5=a5_0x1183c8;try{const _0x5b4e30=(0x0,import_child_process3[_0x10efa5(0x199)])('git\x20rev-parse\x20--abbrev-ref\x20origin/HEAD',{'cwd':_0x3146a3,'stdio':_0x10efa5(0x1e2),'env':{...process['env'],'GIT_TERMINAL_PROMPT':'0'}})[_0x10efa5(0x182)]()[_0x10efa5(0x113)](),_0x440cc0=_0x5b4e30[_0x10efa5(0x102)]('/');return _0x440cc0[_0x10efa5(0x193)]>0x1?_0x440cc0[_0x10efa5(0x122)](0x1)[_0x10efa5(0x136)]('/'):_0x2b4e2a;}catch{return _0x2b4e2a;}}function parseRemoteUrl(_0x4b139f){const _0x15df3c=a5_0x1183c8,_0x5312eb=_0x4b139f['match'](/https?:\/\/[^/]*github\.com\/([^/]+)\/([^/]+?)(\.git)?$/);if(_0x5312eb)return{'owner':_0x5312eb[0x1],'repo':_0x5312eb[0x2]};const _0x1b49e6=_0x4b139f[_0x15df3c(0x138)](/git@github\.com:([^/]+)\/(.+?)(\.git)?$/);if(_0x1b49e6)return{'owner':_0x1b49e6[0x1],'repo':_0x1b49e6[0x2]};return null;}async function pushPolygraphBranch(_0x409404,_0xcefab3){const _0x630e34=a5_0x1183c8,_0x3bf813={...process[_0x630e34(0x170)],'GIT_TERMINAL_PROMPT':'0'},_0x38bf91=getRegistryPath(_0xcefab3['workspacePath'],_0xcefab3[_0x630e34(0x1e9)]),_0x48e185=loadRepoRegistry(_0x38bf91);if(!_0x48e185)return _0x409404['log'](_0x630e34(0xcf)+_0xcefab3[_0x630e34(0x1e9)]),{'success':![],'error':_0x630e34(0x1f5)+_0xcefab3['sessionId'],'phase':_0x630e34(0x135)};const _0x4b8364=_0x48e185['repos'][_0x630e34(0xf7)](_0x11f939=>_0x11f939[_0x630e34(0x16e)]===_0xcefab3[_0x630e34(0x1fe)]);if(!_0x4b8364)return _0x409404['log'](_0x630e34(0xfc)+_0xcefab3[_0x630e34(0x1fe)]+_0x630e34(0x149)),{'success':![],'error':'Repository\x20'+_0xcefab3[_0x630e34(0x1fe)]+_0x630e34(0xd3),'phase':_0x630e34(0x135)};_0x409404[_0x630e34(0x1aa)](_0x630e34(0x177)+_0x4b8364[_0x630e34(0x18e)]+_0x630e34(0x124)+_0x4b8364['workspaceId']+')');const _0xebbdcf=await getPolygraphCredentials(_0x409404,{'sessionId':_0xcefab3['sessionId'],'nxCloudUrl':_0xcefab3[_0x630e34(0x1d1)],'authHeaders':_0xcefab3[_0x630e34(0x181)]});if(!_0xebbdcf[_0x630e34(0xe6)])return _0x409404['log']('Failed\x20to\x20get\x20credentials:\x20'+_0xebbdcf[_0x630e34(0x194)]),{'success':![],'error':_0x630e34(0x1e5)+_0xebbdcf[_0x630e34(0x194)],'phase':'credentials'};const _0x1e3d29=_0xebbdcf[_0x630e34(0x118)][_0x630e34(0xf7)](_0x192f7d=>_0x192f7d[_0x630e34(0x1fd)]===_0x4b8364['workspaceId']);if(!_0x1e3d29)return _0x409404[_0x630e34(0x1aa)]('No\x20credential\x20found\x20for\x20workspace\x20'+_0x4b8364[_0x630e34(0x1fd)]),{'success':![],'error':_0x630e34(0x1e7)+_0x4b8364['workspaceId'],'phase':_0x630e34(0x118)};_0x409404[_0x630e34(0x1aa)]('Retrieved\x20credential\x20for\x20workspace\x20'+_0x4b8364[_0x630e34(0x1fd)]);const [_0x1b17c1,_0x1a0ec3]=_0x4b8364[_0x630e34(0x18e)][_0x630e34(0x102)]('/');try{const _0x59235c=(0x0,import_child_process3['execSync'])(_0x630e34(0x161),{'cwd':_0xcefab3[_0x630e34(0x1fe)],'stdio':_0x630e34(0x1e2),'env':_0x3bf813})['toString']()[_0x630e34(0x113)]();_0x409404[_0x630e34(0x1aa)](_0x630e34(0x1df)+_0x59235c);const _0x3da860=parseRemoteUrl(_0x59235c);if(!_0x3da860)return{'success':![],'error':'Unable\x20to\x20parse\x20remote\x20origin\x20URL:\x20'+_0x59235c,'phase':_0x630e34(0x135)};if(_0x3da860[_0x630e34(0x1c0)][_0x630e34(0x121)]()!==_0x1b17c1[_0x630e34(0x121)]()||_0x3da860['repo'][_0x630e34(0x121)]()!==_0x1a0ec3[_0x630e34(0x121)]())return _0x409404[_0x630e34(0x1aa)]('Remote\x20mismatch:\x20expected\x20'+_0x1b17c1+'/'+_0x1a0ec3+_0x630e34(0x15e)+_0x3da860[_0x630e34(0x1c0)]+'/'+_0x3da860[_0x630e34(0xfa)]),{'success':![],'error':_0x630e34(0x196)+_0x1b17c1+'/'+_0x1a0ec3,'phase':'validation'};}catch(_0x39a7c8){const _0x405091=_0x39a7c8 instanceof Error?_0x39a7c8['message']:String(_0x39a7c8);return _0x409404[_0x630e34(0x1aa)](_0x630e34(0x1d4)+sanitizeError(_0x405091)),{'success':![],'error':_0x630e34(0x202)+sanitizeError(_0x405091),'phase':'validation'};}const _0x2296ca=validateGitRef(_0xcefab3[_0x630e34(0xdb)],'Branch\x20name');if(_0x2296ca)return{'success':![],'error':_0x2296ca,'phase':'validation'};const _0x16faa7=getDefaultBranch(_0xcefab3['repoPath']),_0x2975e6=validateGitRef(_0x16faa7,_0x630e34(0x14c));if(_0x2975e6)return{'success':![],'error':_0x2975e6,'phase':'validation'};_0x409404['log']('Checking\x20commits\x20ahead\x20of\x20'+_0x16faa7);try{const _0x5bb1e9=(0x0,import_child_process3[_0x630e34(0xd4)])('git',[_0x630e34(0x18f),_0x630e34(0x17c),'origin/'+_0x16faa7+_0x630e34(0x10f)],{'cwd':_0xcefab3['repoPath'],'stdio':_0x630e34(0x1e2),'env':_0x3bf813})[_0x630e34(0x182)]()['trim']();if(_0x5bb1e9==='0')return _0x409404[_0x630e34(0x1aa)](_0x630e34(0x1ae)),{'success':![],'error':_0x630e34(0x114),'phase':'validation'};_0x409404[_0x630e34(0x1aa)](_0x5bb1e9+_0x630e34(0x1ca)+_0x16faa7);}catch(_0x53d633){const _0x4b1f4f=_0x53d633 instanceof Error?_0x53d633[_0x630e34(0x18b)]:String(_0x53d633);return _0x409404[_0x630e34(0x1aa)](_0x630e34(0x204)+sanitizeError(_0x4b1f4f)),{'success':![],'error':'Failed\x20to\x20check\x20commits\x20ahead:\x20'+sanitizeError(_0x4b1f4f),'phase':_0x630e34(0x135)};}const _0x401f45=_0x630e34(0x150)+_0x1e3d29['token']+'@github.com/'+_0x1b17c1+'/'+_0x1a0ec3+_0x630e34(0x10d);_0x409404[_0x630e34(0x1aa)](_0x630e34(0x1af)+_0xcefab3[_0x630e34(0xdb)]+'\x20to\x20origin');try{(0x0,import_child_process3[_0x630e34(0xd4)])(_0x630e34(0xda),['push',_0x630e34(0x16a),_0x401f45,_0x630e34(0x1b7)+_0xcefab3[_0x630e34(0xdb)]],{'cwd':_0xcefab3[_0x630e34(0x1fe)],'stdio':_0x630e34(0x1e2),'env':_0x3bf813}),_0x409404[_0x630e34(0x1aa)](_0x630e34(0x1b2)+_0xcefab3[_0x630e34(0xdb)]);}catch(_0x567879){const _0x11a432=_0x567879 instanceof Error?_0x567879[_0x630e34(0x18b)]:String(_0x567879),_0x9b04d3=sanitizeError(_0x11a432);return _0x409404[_0x630e34(0x1aa)](_0x630e34(0x186)+_0x9b04d3),{'success':![],'error':_0x630e34(0x137)+_0x9b04d3,'phase':_0x630e34(0x17e)};}return{'success':!![],'branch':_0xcefab3[_0x630e34(0xdb)],'remote':_0x630e34(0xe9)};}async function polygraphInit(_0x541ce5,_0x5f594b){const _0x46cb8f=a5_0x1183c8,{sessionId:_0x4ff198,nxCloudId:_0x268246,nxCloudUrl:_0x52b0df,authHeaders:_0x1c28fb,workspacePath:_0x2d4952}=_0x5f594b,_0x129bb2=await initPolygraphSession(_0x541ce5,{'sessionId':_0x4ff198,'nxCloudId':_0x268246,'nxCloudUrl':_0x52b0df,'authHeaders':_0x1c28fb});if(_0x129bb2[_0x46cb8f(0x194)])return{'success':![],'error':_0x46cb8f(0x1ac)+_0x129bb2[_0x46cb8f(0x194)][_0x46cb8f(0x18b)]+_0x46cb8f(0x1b0)+_0x129bb2['url']};const _0x532c46=_0x129bb2[_0x46cb8f(0x168)];if(!(_0x532c46==null?void 0x0:_0x532c46[_0x46cb8f(0x131)])||_0x532c46['workspaces'][_0x46cb8f(0x193)]===0x0)return{'success':!![],'sessionId':_0x4ff198,'clonesSummary':_0x46cb8f(0x129)+_0x4ff198};const _0x42c44=await clonePolygraphRepositories(_0x2d4952,_0x541ce5,_0x532c46);if(!_0x42c44['success'])return{'success':![],'error':_0x46cb8f(0xcd)+_0x42c44[_0x46cb8f(0x194)]};const _0x50e74=_0x42c44[_0x46cb8f(0xdc)][_0x46cb8f(0xef)](_0x397f80=>'-\x20'+_0x397f80[_0x46cb8f(0x18e)]+':\x20'+_0x397f80['localPath'])['join']('\x0a');return{'success':!![],'sessionId':_0x4ff198,'clonesSummary':_0x46cb8f(0x16b)+_0x4ff198+'\x0a\x0aCloned\x20repositories:\x0a'+_0x50e74+_0x46cb8f(0x190)};}var childAgentManager;function getChildAgentManager(_0x375617){const _0x7b3750=a5_0x1183c8;if(!childAgentManager){childAgentManager=new ChildAgentManager(_0x375617);const _0x1aaee2=()=>childAgentManager[_0x7b3750(0xf0)]();process['on']('exit',_0x1aaee2),process['on'](_0x7b3750(0xe0),_0x1aaee2),process['on'](_0x7b3750(0x1cb),_0x1aaee2);}return childAgentManager;}function polygraphDelegate(_0x1fb04d,_0x19ebf1){const _0x274600=a5_0x1183c8,_0x1e38f6=getChildAgentManager(_0x1fb04d),{sessionId:_0x3ed5e2,target:_0x1cd2b1,instruction:_0x45cbac,context:_0x5d4abd,workspacePath:_0x3491f4}=_0x19ebf1,_0x141973=getRegistryPath(_0x3491f4,_0x3ed5e2),_0x4549b6=loadRepoRegistry(_0x141973);if(!_0x4549b6)return{'success':![],'error':_0x274600(0x1f5)+_0x3ed5e2+_0x274600(0x200)};const _0x188835=_0x4549b6[_0x274600(0x1a7)][_0x274600(0xf7)](_0x362a36=>_0x362a36[_0x274600(0x1fd)]===_0x1cd2b1||_0x362a36[_0x274600(0x18e)]===_0x1cd2b1||_0x362a36[_0x274600(0x18e)][_0x274600(0x1ec)]('/'+_0x1cd2b1));if(!_0x188835){const _0x2c91cd=_0x4549b6[_0x274600(0x1a7)][_0x274600(0xef)](_0x1d952c=>{const _0x53b41c=_0x274600,_0x5c5ac7=_0x1d952c['repoFullName'][_0x53b41c(0x102)]('/')[_0x53b41c(0x141)]()??_0x1d952c[_0x53b41c(0x18e)];return _0x5c5ac7+'\x20('+_0x1d952c[_0x53b41c(0x18e)]+')';})[_0x274600(0x136)](',\x20');return{'success':![],'error':_0x274600(0x1e1)+_0x1cd2b1+_0x274600(0x1d8)+_0x3ed5e2+_0x274600(0x191)+_0x2c91cd};}_0x1fb04d[_0x274600(0x1aa)]('Delegating\x20task\x20to\x20'+_0x188835['repoFullName']+_0x274600(0xd0)+_0x188835[_0x274600(0x16e)]);const _0x4c6263=_0x1e38f6[_0x274600(0x1ab)](_0x188835[_0x274600(0x1fd)],_0x188835[_0x274600(0x16e)],_0x45cbac,_0x5d4abd);return _0x4c6263[_0x274600(0x192)]?{'success':!![],'message':_0x274600(0x1c3)+_0x188835['repoFullName']+'.\x20Use\x20cloud_polygraph_child_status\x20to\x20monitor\x20progress.'}:{'success':![],'error':_0x4c6263[_0x274600(0x194)]};}async function polygraphPushBranch(_0x4d77bf,_0x5bd3c9){const _0x54056f=a5_0x1183c8,_0x3f9535=await pushPolygraphBranch(_0x4d77bf,_0x5bd3c9);if(!_0x3f9535[_0x54056f(0xe6)])return{'success':![],'error':_0x3f9535[_0x54056f(0x194)]};return{'success':!![],'branch':_0x3f9535[_0x54056f(0xdb)]};}async function saveSessionPlan(_0x42e8ae,_0xc38b9d,_0x205edb,_0x4d6b23,_0x3f4f97,_0x3fe040){const _0x5005cf=a5_0x1183c8;try{const _0x24418e=_0xc38b9d+_0x5005cf(0x11b)+_0x4d6b23+_0x5005cf(0x18d),_0x21b1f5=new AbortController(),_0x4e4caa=setTimeout(()=>_0x21b1f5[_0x5005cf(0x116)](),POLYGRAPH_FETCH_TIMEOUT_MS);await fetch(_0x24418e,{'method':_0x5005cf(0x1f1),'headers':{'Content-Type':_0x5005cf(0x14d),..._0x205edb},'body':JSON[_0x5005cf(0x125)]({'plan':_0x3f4f97,'agentSessionId':_0x3fe040}),'signal':_0x21b1f5['signal']}),clearTimeout(_0x4e4caa);}catch(_0x2b8d16){_0x42e8ae[_0x5005cf(0x1aa)](_0x5005cf(0x156)+(_0x2b8d16 instanceof Error?_0x2b8d16['message']:String(_0x2b8d16)));}}async function polygraphCreatePRs(_0x354aab,_0x4d5f9f){const _0x3681aa=a5_0x1183c8,_0x4aaf9d=[],_0x5d8d8b=getRegistryPath(_0x4d5f9f[_0x3681aa(0x146)],_0x4d5f9f[_0x3681aa(0x1e9)]),_0x1bc837=loadRepoRegistry(_0x5d8d8b);if(!_0x1bc837)return{'success':![],'error':'No\x20Polygraph\x20session\x20found\x20with\x20ID:\x20'+_0x4d5f9f[_0x3681aa(0x1e9)]};for(const _0x25a41c of _0x4d5f9f[_0x3681aa(0x14b)]){const {owner:_0x391b11,repo:_0x319435}=_0x25a41c,_0x28b91b=_0x1bc837[_0x3681aa(0x1a7)]['find'](_0x10f316=>_0x10f316['repoFullName']===_0x391b11+'/'+_0x319435);if(!_0x28b91b){_0x4aaf9d['push']({'owner':_0x391b11,'repo':_0x319435,'success':![],'error':_0x3681aa(0xfc)+_0x391b11+'/'+_0x319435+_0x3681aa(0xd3)});continue;}try{const _0x3b6696=await createPolygraphPR(_0x354aab,{'sessionId':_0x4d5f9f[_0x3681aa(0x1e9)],'nxCloudUrl':_0x4d5f9f['nxCloudUrl'],'authHeaders':_0x4d5f9f[_0x3681aa(0x181)],'title':_0x25a41c['title'],'body':_0x25a41c[_0x3681aa(0x10e)],'headBranch':_0x25a41c['headBranch'],'baseBranch':_0x25a41c[_0x3681aa(0x1cf)],'workspaceId':_0x28b91b[_0x3681aa(0x1fd)]});_0x3b6696[_0x3681aa(0xe6)]?_0x4aaf9d[_0x3681aa(0x17e)]({'owner':_0x391b11,'repo':_0x319435,'success':!![],'url':_0x3b6696[_0x3681aa(0x1e6)],'number':_0x3b6696[_0x3681aa(0x15c)],'title':_0x3b6696[_0x3681aa(0x1c1)]}):_0x4aaf9d[_0x3681aa(0x17e)]({'owner':_0x391b11,'repo':_0x319435,'success':![],'error':_0x3b6696[_0x3681aa(0x194)]});}catch(_0xc0bda1){const _0x4131b2=_0xc0bda1 instanceof Error?_0xc0bda1[_0x3681aa(0x18b)]:String(_0xc0bda1);_0x4aaf9d[_0x3681aa(0x17e)]({'owner':_0x391b11,'repo':_0x319435,'success':![],'error':_0x4131b2});}}return _0x4d5f9f[_0x3681aa(0x145)]&&saveSessionPlan(_0x354aab,_0x4d5f9f['nxCloudUrl'],_0x4d5f9f[_0x3681aa(0x181)],_0x4d5f9f[_0x3681aa(0x1e9)],_0x4d5f9f[_0x3681aa(0x145)],_0x4d5f9f[_0x3681aa(0x16f)]),{'success':!![],'results':_0x4aaf9d};}async function polygraphGetSession(_0x37ce8e,_0x27ed42){return await getPolygraphSession(_0x37ce8e,_0x27ed42);}function formatPrCiStatus(_0x4a0aab,_0x2f7fe6){const _0x50680c=a5_0x1183c8,_0x18a601=_0x2f7fe6[_0x4a0aab['id']];if(!_0x18a601||!_0x18a601['status'])return _0x50680c(0x15f);const _0x2b5390=[_0x50680c(0x15d)+_0x18a601[_0x50680c(0x203)]];return _0x18a601[_0x50680c(0x208)]&&_0x2b5390[_0x50680c(0x17e)](_0x50680c(0xe7)+_0x18a601[_0x50680c(0x208)]),_0x2b5390[_0x50680c(0x136)]('\x0a');}function formatPolygraphSession(_0x68116){const _0x4371d8=a5_0x1183c8;var _0x41c4ad;const _0x59d0fb=[];_0x59d0fb[_0x4371d8(0x17e)](_0x4371d8(0x1ee)+_0x68116['sessionId']),_0x59d0fb[_0x4371d8(0x17e)](_0x4371d8(0x119)+_0x68116[_0x4371d8(0x183)]),_0x59d0fb[_0x4371d8(0x17e)](_0x4371d8(0x1ef)+(_0x68116['completed']?_0x4371d8(0x1eb):_0x4371d8(0xf1))),_0x59d0fb['push']('');if(_0x68116[_0x4371d8(0x131)][_0x4371d8(0x193)]>0x0){_0x59d0fb[_0x4371d8(0x17e)](_0x4371d8(0x100));for(const _0x12cff0 of _0x68116[_0x4371d8(0x131)]){const _0x3c87b0=((_0x41c4ad=_0x12cff0[_0x4371d8(0x1bc)])==null?void 0x0:_0x41c4ad[_0x4371d8(0x104)])??_0x12cff0['name'],_0x437022=_0x12cff0[_0x4371d8(0x1cc)]?'\x20(initiator)':'';_0x59d0fb[_0x4371d8(0x17e)]('-\x20'+_0x3c87b0+_0x437022);}_0x59d0fb[_0x4371d8(0x17e)]('');}if(_0x68116[_0x4371d8(0x1d2)][_0x4371d8(0x193)]>0x0){_0x59d0fb[_0x4371d8(0x17e)]('Pull\x20Requests:');for(const _0x1e8c36 of _0x68116[_0x4371d8(0x1d2)]){_0x59d0fb[_0x4371d8(0x17e)]('-\x20'+_0x1e8c36['title']+'\x20['+_0x1e8c36[_0x4371d8(0x203)]+']'),_0x59d0fb[_0x4371d8(0x17e)]('\x20\x20Branch:\x20'+_0x1e8c36[_0x4371d8(0xdb)]),_0x59d0fb[_0x4371d8(0x17e)](_0x4371d8(0x11d)+_0x1e8c36[_0x4371d8(0x1e6)]),_0x59d0fb[_0x4371d8(0x17e)](formatPrCiStatus(_0x1e8c36,_0x68116['ciStatus']??{}));}_0x59d0fb['push']('');}if(_0x68116[_0x4371d8(0x207)][_0x4371d8(0x12d)]['length']>0x0||_0x68116[_0x4371d8(0x207)][_0x4371d8(0x19a)][_0x4371d8(0x193)]>0x0){_0x59d0fb['push'](_0x4371d8(0x19c)),_0x59d0fb['push'](_0x4371d8(0xf8)+_0x68116[_0x4371d8(0x207)][_0x4371d8(0x12d)][_0x4371d8(0x136)](',\x20'));for(const _0x50d326 of _0x68116[_0x4371d8(0x207)][_0x4371d8(0x19a)]){_0x59d0fb['push']('\x20\x20'+_0x50d326[_0x4371d8(0x1db)]+_0x4371d8(0x166)+_0x50d326[_0x4371d8(0x15a)]);}}return _0x59d0fb[_0x4371d8(0x136)]('\x0a');}async function polygraphMarkReady(_0x3524fd,_0x56590b){const _0x7ae56f=a5_0x1183c8,_0x4623fe=await markPolygraphPRsReady(_0x3524fd,_0x56590b);return _0x56590b[_0x7ae56f(0x145)]&&saveSessionPlan(_0x3524fd,_0x56590b[_0x7ae56f(0x1d1)],_0x56590b[_0x7ae56f(0x181)],_0x56590b[_0x7ae56f(0x1e9)],_0x56590b['plan'],_0x56590b[_0x7ae56f(0x16f)]),_0x4623fe;}async function polygraphAssociatePR(_0x5dec26,_0x54dcfc){const _0xd507c1=a5_0x1183c8,_0x170b7d=await associatePolygraphPR(_0x5dec26,_0x54dcfc);return _0x54dcfc['plan']&&saveSessionPlan(_0x5dec26,_0x54dcfc[_0xd507c1(0x1d1)],_0x54dcfc[_0xd507c1(0x181)],_0x54dcfc[_0xd507c1(0x1e9)],_0x54dcfc[_0xd507c1(0x145)],_0x54dcfc[_0xd507c1(0x16f)]),_0x170b7d;}async function polygraphStopChild(_0x323a8b,_0x3ad7cc){const _0x1f3acb=a5_0x1183c8,_0x39f068=getChildAgentManager(_0x323a8b),{sessionId:_0x5e7460,target:_0x5b15e8,workspacePath:_0x5bfcde}=_0x3ad7cc,_0x179e5c=getRegistryPath(_0x5bfcde,_0x5e7460),_0x43cf2b=loadRepoRegistry(_0x179e5c);if(!_0x43cf2b)return{'success':![],'error':'No\x20Polygraph\x20session\x20found\x20with\x20ID:\x20'+_0x5e7460+'.\x20Run\x20cloud_polygraph_init\x20first.'};const _0x780bdd=_0x43cf2b['repos']['find'](_0xa1ee3f=>_0xa1ee3f[_0x1f3acb(0x1fd)]===_0x5b15e8||_0xa1ee3f['repoFullName']===_0x5b15e8||_0xa1ee3f['repoFullName'][_0x1f3acb(0x1ec)]('/'+_0x5b15e8));if(!_0x780bdd){const _0xf042e4=_0x43cf2b[_0x1f3acb(0x1a7)]['map'](_0x1825e3=>{const _0x2b1155=_0x1f3acb,_0x56fc71=_0x1825e3[_0x2b1155(0x18e)]['split']('/')[_0x2b1155(0x141)]()??_0x1825e3[_0x2b1155(0x18e)];return _0x56fc71+'\x20('+_0x1825e3[_0x2b1155(0x18e)]+')';})[_0x1f3acb(0x136)](',\x20');return{'success':![],'error':'Repository\x20\x22'+_0x5b15e8+'\x22\x20not\x20found\x20in\x20session\x20'+_0x5e7460+_0x1f3acb(0x191)+_0xf042e4};}_0x323a8b[_0x1f3acb(0x1aa)](_0x1f3acb(0x126)+_0x780bdd['repoFullName']);const _0x479ab1=_0x39f068['stopChild'](_0x780bdd[_0x1f3acb(0x1fd)]);if(!_0x479ab1[_0x1f3acb(0x1ce)])return{'success':![],'error':'No\x20active\x20child\x20agent\x20found\x20for\x20workspace\x20'+_0x780bdd[_0x1f3acb(0x18e)]};return{'success':!![],'output':_0x479ab1[_0x1f3acb(0x1f9)],'message':_0x1f3acb(0x1bb)+_0x780bdd[_0x1f3acb(0x18e)]+_0x1f3acb(0xf6)};}async function polygraphChildStatus(_0x36c6ed,_0x44adf8){const _0x4f2a06=a5_0x1183c8,_0xd58072=getChildAgentManager(_0x36c6ed),{sessionId:_0x403644,target:_0x2ea4df,workspacePath:_0x2e7571,tail:tail=0x32}=_0x44adf8,_0x2e6625=getRegistryPath(_0x2e7571,_0x403644),_0x5b099d=loadRepoRegistry(_0x2e6625);if(!_0x5b099d)return{'success':![],'error':_0x4f2a06(0x1f5)+_0x403644+'.\x20Run\x20cloud_polygraph_init\x20first.'};const _0x592b85=_0xd58072[_0x4f2a06(0xee)](),_0x2d84=[];for(const _0x268bc8 of _0x592b85){const _0x39bc1c=_0x5b099d[_0x4f2a06(0x1a7)][_0x4f2a06(0xf7)](_0x393869=>_0x393869[_0x4f2a06(0x1fd)]===_0x268bc8['workspaceId']);if(!_0x39bc1c)continue;if(_0x2ea4df&&_0x268bc8[_0x4f2a06(0x1fd)]!==_0x2ea4df&&_0x39bc1c[_0x4f2a06(0x18e)]!==_0x2ea4df&&!_0x39bc1c[_0x4f2a06(0x18e)][_0x4f2a06(0x1ec)]('/'+_0x2ea4df))continue;const _0x4f3deb=_0xd58072['getChildOutput'](_0x268bc8[_0x4f2a06(0x1fd)],tail)??'';_0x2d84[_0x4f2a06(0x17e)]({'workspaceId':_0x268bc8['workspaceId'],'repoFullName':_0x39bc1c[_0x4f2a06(0x18e)],'status':_0x268bc8[_0x4f2a06(0x203)],'lastOutputLines':_0x4f3deb,'durationMs':_0x268bc8[_0x4f2a06(0x1f7)],'instruction':_0x268bc8[_0x4f2a06(0x1f8)]});}if(_0x2ea4df&&_0x2d84[_0x4f2a06(0x193)]===0x0)return{'success':![],'error':_0x4f2a06(0x160)+_0x2ea4df+_0x4f2a06(0x13d)+_0x403644+'.'};return{'success':!![],'children':_0x2d84};}0x0&&(module[a5_0x1183c8(0x174)]={'formatPolygraphSession':formatPolygraphSession,'polygraphAssociatePR':polygraphAssociatePR,'polygraphChildStatus':polygraphChildStatus,'polygraphCreatePRs':polygraphCreatePRs,'polygraphDelegate':polygraphDelegate,'polygraphGetSession':polygraphGetSession,'polygraphInit':polygraphInit,'polygraphMarkReady':polygraphMarkReady,'polygraphPushBranch':polygraphPushBranch,'polygraphStopChild':polygraphStopChild});